Packet Structure ideas?

CMSG = client message
SMSG = server message

I) Client side
	1) Client presses a key, sends to server
		packets:
			CMSG_SEND_COMMAND
				int32 - alternatively send command flags as defined in Input
	2) Client does the math and sends state update
		packets:
			CMSG_UPDATE_STATE
				int(size) guid; - need to define maximum Entities
				int32 flags;
				[float float float] - position
				[float float] - rotation
				[float] - torque
				[float] - speed
				[int32] - hp
				[float] - acceleration
			CMSG_FIRE_LASER
				int(size) shooterGUID; - need to define maximum Entities
				int(size) laserGUID;
				float - radians - horizontal
				float - radians - vertical
				-- there's gotta be a better way? use vectors?
				int8 laserPower
			CMSG_CHALLENGE_UPDATE -- allows server to do bad things to cheaters
				int(size) challengerGUID; - need to define maximum Entities
				int(size) challengedGUID; - need to define maximum Entities

II) Server side
	1) Server sends all the nasty updates
		SMSG_UPDATE_STATE
			int(size) guid; - need to define maximum Entities
			int32 flags; - so that we can send multiple updates in one packet
			[float float float] - position
			[float float] - rotation
			[float] - torque
			[float] - speed
			[int32] - hp
			[float] - acceleration
			[boolean] - dead
		SMSG_LASER_FIRED
			int(size) shooterGUID;
			int(size) laserGUID;
			float float - rotation
			int8 laserPower;
		[ -- if we don't allow chat ignore this block
		SMSG_SEND_CHAT_MESSAGE
			int(size) senderGUID;
			int32 messageLength;
			char[messageLength]; ]
		SMSG_SPAWN_ENTITY
			int(size) guid;
			int8 type;
			float float float - position
			float float - rotation
			float torque;
			float speed;
			int32 hp;
			float acceleration;
			boolean dead;
			boolean isExplosion;
			if (isExplosion) int8 age
		SMSG_YOU_WERE_STRUCK
			int(size) shooterGUID;
			int32 damage;
			float float - direction from
	2) Server just relays client info after checking it, no new packet
		SMSG_RELAY_PACKET
			packet goes here
			